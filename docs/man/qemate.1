.TH QEMATE 1 "May 30, 2025" "Qemate 3.0.1" "User Commands"
.SH NAME
qemate \- Manage QEMU virtual machines from the command line
.SH SYNOPSIS
.B qemate
.I COMMAND
[
.I SUBCOMMAND
] [
.I OPTIONS
]
.SH DESCRIPTION
.B Qemate
is a streamlined command-line utility for managing QEMU virtual machines (VMs). It simplifies VM creation, control, and configuration, leveraging QEMU with KVM acceleration for enhanced performance when supported by the host system.

Qemate requires QEMU (specifically
.B qemu-system-x86_64
and
.B qemu-img
commands, version 9.0 or higher) and Bash (version 5.0 or higher) to be installed. Optional dependencies include PipeWire (preferred), PulseAudio, or ALSA for audio support, and Samba for Windows folder sharing. Logging verbosity is controlled by the
.B LOG_LEVEL
environment variable (DEBUG, INFO, WARNING, ERROR; default: INFO).
.SH COMMANDS
.TP
.B vm
Manage virtual machines.
.RS
.TP
.B create NAME [--os-type TYPE] [--memory SIZE] [--cores N] [--disk-size SIZE] [--machine TYPE] [--enable-audio]
Create a new VM with the specified name.

Options:
.RS
.TP
.B --memory SIZE
Memory size (e.g., 4G, 2048M; default: 2G for Linux, 4G for Windows).
.TP
.B --cores N
Number of CPU cores (1-64; default: 2 for Linux, 2 for Windows).
.TP
.B --disk-size SIZE
Disk size (e.g., 20G; default: 20G for Linux, 60G for Windows).
.TP
.B --machine TYPE
Machine type (e.g., q35,accel=kvm or pc,accel=tcg; default: q35,accel=kvm).
.TP
.B --os-type TYPE
Operating system type (linux, windows; default: linux). Influences defaults like VirtIO and disk interface.
.TP
.B --enable-audio
Enable audio for the VM (requires PipeWire, PulseAudio, or ALSA).
.RE
.TP
.B start NAME [--iso PATH] [--headless]
Start the VM with the given name.

Options:
.RS
.TP
.B --iso PATH
Path to an ISO file to boot from (e.g., for installation or recovery).
.TP
.B --headless
Run without a graphical console (uses -display none).
.RE
.TP
.B stop NAME [--force]
Stop the VM. Use --force to terminate immediately (SIGKILL) if graceful shutdown (SIGTERM) fails.
.TP
.B status NAME
Display detailed status of the VM (e.g., state, memory, disk usage, network configuration).
.TP
.B delete NAME [--force]
Delete the VM and its associated files. Use --force to skip confirmation.
.TP
.B list
List all VMs with their name, status, and lock state.
.TP
.B resize NAME SIZE [--force]
Resize the VM's disk to the specified size (e.g., 50G). Shrinking is not supported. Use --force to bypass safety checks (e.g., VM running or locked).
.TP
.B configure NAME [SETTING VALUE]
Configure VM settings or open the configuration file in the default editor ($EDITOR, defaults to nano if unset). Supported settings:
.RS
.TP
.B cores
Set number of CPU cores (1-64).
.TP
.B memory
Set memory size (e.g., 4G, 2048M).
.TP
.B audio
Enable/disable audio (on/off, enable/disable, 1/0, true/false).
.RE
.RE
.TP
.B net
Manage network configuration.
.RS
.TP
.B type NAME [nat|user|none]
Set or display the network type for the VM (default: user).
.TP
.B model NAME [e1000|virtio-net-pci|rtl8139]
Set or display the network device model (default: virtio-net-pci for Linux, e1000 for Windows).
.TP
.B port add NAME HOST_PORT:GUEST_PORT[:tcp|udp]
Add a port forward (e.g., 8080:80 or 8080:80:tcp). Protocol defaults to tcp.
.TP
.B port remove NAME HOST_PORT:GUEST_PORT[:tcp|udp]
Remove a port forward (e.g., 8080:80 or 8080:80:tcp). Protocol defaults to tcp.
.RE
.TP
.B shared
Manage shared folders (limited to one folder per VM).
.RS
.TP
.B list NAME
List the configured shared folder for the VM.
.TP
.B add NAME HOST_PATH [MOUNT_TAG [SECURITY_MODEL]]
Add a single host folder to share with the VM (requires VirtIO for Linux, Samba for Windows). MOUNT_TAG is optional (defaults to an MD5-based tag). SECURITY_MODEL defaults to mapped-xattr.
.TP
.B remove NAME HOST_PATH_OR_MOUNT_TAG
Remove the shared folder from the VM by its path or mount tag.
.RE
.TP
.B security
Manage VM security settings.
.RS
.TP
.B lock NAME
Lock the VM to prevent modifications or deletion.
.TP
.B unlock NAME
Unlock the VM, allowing modifications or deletion.
.RE
.TP
.B help
Display the main help message.
.TP
.B version
Display the program version (3.0.1).
.SH EXAMPLES
Create a Linux VM with 4GB memory and 4 cores:
.EX
qemate vm create myvm --os-type linux --memory 4G --cores 4
.EE
Start a VM with an ISO in headless mode:
.EX
qemate vm start myvm --iso /path/to/install.iso --headless
.EE
Resize a VM's disk to 50G:
.EX
qemate vm resize myvm 50G
.EE
Configure VM CPU cores:
.EX
qemate vm configure myvm cores 4
.EE
Enable audio for a VM:
.EX
qemate vm configure myvm audio on
.EE
Add a TCP port forward from host 8080 to guest 80:
.EX
qemate net port add myvm 8080:80
.EE
Add a UDP port forward from host 53 to guest 53:
.EX
qemate net port add myvm 53:53:udp
.EE
Set network type to NAT:
.EX
qemate net type myvm nat
.EE
Add a shared folder with a custom mount tag:
.EX
qemate shared add myvm ~/Documents mydocs mapped-xattr
.EE
Remove a shared folder by path:
.EX
qemate shared remove myvm ~/Documents
.EE
Remove a shared folder by mount tag:
.EX
qemate shared remove myvm mydocs
.EE
List all VMs:
.EX
qemate vm list
.EE
Show version:
.EX
qemate version
.EE
Lock a VM:
.EX
qemate security lock myvm
.EE
.SH FILES
.TP
.I ~/QVMs/VM_NAME/config
Configuration file for each VM. (Path customizable via $QEMATE_VM_DIR)
.TP
.I ~/QVMs/VM_NAME/disk.qcow2
Disk image for each VM.
.TP
.I ~/QVMs/VM_NAME/logs/qemate_vm.log
Per-VM log file. Verbosity controlled by the LOG_LEVEL environment variable.
.TP
.I ~/QVMs/VM_NAME/logs/error.log
Error log file for the VM.
.TP
.I ~/QVMs/VM_NAME/qemu.pid
PID file for running VMs.
.SH EXIT STATUS
.TP
0
Success
.TP
1
Failure
.SH AUTHOR
Daniel Zilli
.SH LICENSE
MIT License